<!DOCTYPE html>
<html lang="ja">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="format-detection" content="telephone=no" />

  <title>Network Information | Battery Status</title>
  <meta content="ブラウザのオンライン状態・ネットワーク接続情報などを提供する、システムのバッテリーに関する情報 API" name="description">

  <script src="../../ver/js/menu.js"></script>
  <script src="battery.js"></script>
  <script src="navigator.js"></script>
  <script type="text/javascript">
    menuJSON('index.json')
  </script>

  <link rel="icon" href="../../ver/icon/favicon.png" type="image/png">
  <link rel="stylesheet" href="../../ver/css/menu.css" />
  <link rel="stylesheet" href="../../ver/css/howto.css" />
  <style>
    #howto details {
      max-width: 750px;
    }

    #howto meter {
      width: 100%;
      height: 350px;
    }

    #howto b {
      color: red;
    }

    #howto meter::-webkit-meter-horizontal-bar {
      border: double 5px #000;
    }

    @media screen and (max-width: 750px) {
      #howto meter {
        height: 45vw;
      }
    }
  </style>
</head>

<body ononline="update(true)" onoffline="update(false)" onload="update(navigator.onLine)">
  <header id="menu" hidden>
    <button><b></b></button>
    <menu id="contents">
      <a href="/profile/" target="_parent">
        <p>The Information About Network & Browser</p>
        <u>通信情報／ブラウザ等情報</u>
      </a>
    </menu>
  </header>

  <article id="howto">
    <details>
      <summary>
        <strong id="status">(Online or Offline?)</strong><br />
        <code>ブラウザのオンライン状態</code>
      </summary>
      <aside>
        <a href="https://developer.mozilla.org/ja/docs/Web/API/Navigator/onLine">
          <i>Navigator.onLine</i>
          <p>ブラウザのオンライン状態を返すプロパティ</p>
        </a>
        <a href="https://developer.mozilla.org/ja/docs/Web/API/Window/online_event">
          <i>ononline</i>
          <p>addEventListener('online', (event) => { });</p>
        </a>
        <a href="https://developer.mozilla.org/ja/docs/Web/API/Window/offline_event">
          <i>onoffline</i>
          <p>addEventListener('offline', (event) => { });</p>
        </a>
      </aside>
      <pre>
body <b>ononline</b>="update(true)" <b>onoffline</b>="update(false)" <b>onload</b>="update(<b>navigator.onLine</b>)"
      </pre>
      <pre>
function <b>update</b>(online) {
  document.querySelector('#status').textContent =
  online ? 'Online' : 'Offline';
}
      </pre>
    </details>
    <details>
      <summary>
        <strong id="network">navigator.connection</strong><br />
        <code>ネットワーク接続情報</code>
      </summary>
      <aside>
        <a href="https://developer.mozilla.org/ja/docs/Web/API/Network_Information_API">
          <i>Network Information API</i>
          <p>ネットワーク情報 API</p>
        </a>
        <a href="https://developer.mozilla.org/ja/docs/Web/API/NetworkInformation/effectiveType">
          <i>NetworkInformation.effectiveType</i>
          <p>'slow-2g', '2g', '3g', '4g' のいずれかを意味する接続の有効な種類</p>
        </a>
        <a href="https://developer.mozilla.org/ja/docs/Web/API/NetworkInformation/type">
          <i>NetworkInformation.type</i>
          <p>端末がネットワーク通信に使用している接続の種類</p>
        </a>
        <a href="https://developer.mozilla.org/ja/docs/Web/API/NetworkInformation/downlink">
          <i>NetworkInformation.downlink</i>
          <p>実効帯域幅の推定値 (メガビット毎秒)</p>
        </a>
        <a href="https://developer.mozilla.org/ja/docs/Web/API/NetworkInformation/rtt">
          <i>NetworkInformation.rtt</i>
          <p>推定有効ラウンドトリップ時間を、25 ミリ秒の倍数に丸めた値</p>
        </a>
        <a href="https://developer.mozilla.org/ja/docs/Web/API/NetworkInformation/change_event">
          <i>change イベント</i>
          <p>接続情報が変更されたときに発行されるイベント</p>
        </a>
      </aside>
      <pre>
const <b>connectionInfo</b> = <b>navigator.connection</b>;
if (connectionInfo !== undefined) {
  const init = function() {
    document.getElementById('network').innerHTML =
    'Network Type <b>' + connectionInfo.effectiveType + '</b> <b>' + connectionInfo.type + '</b> | '
    + 'Downlink <b>' + connectionInfo.downlink + '</b> Mb/s | '
    + 'RTT <b>'+ connectionInfo.rtt + '</b> ms'
  }
  init()

  if (<b>'onchange'</b> in connectionInfo) {
    connectionInfo.addEventListener('change', init)
  } else if (<b>'ontypechange'</b> in connectionInfo) {
    connectionInfo.addEventListener('typechange', init)
  }
}
      </pre>
    </details>
    <details>
      <summary>
        <strong id="navigator">navigator.deviceMemory</strong><br />
        <code>端末のおよそのメモリ量／論理プロセッサーのコア数</code>
      </summary>
      <aside>
        <a href="https://developer.mozilla.org/ja/docs/Web/API/Navigator/deviceMemory">
          <i>navigator.deviceMemory</i>
          <p>端末のおよそのメモリ量 (ギガバイト単位)</p>
        </a>
        <a href="https://developer.mozilla.org/ja/docs/Web/API/Navigator/hardwareConcurrency">
          <i>navigator.hardwareConcurrency</i>
          <p>論理プロセッサーのコア数を示す数値</p>
        </a>
      </aside>
      <pre>
const <b>memory</b> = <b>navigator.deviceMemory</b>;
const <b>hardware</b> = <b>navigator.hardwareConcurrency</b>;
document.querySelector('#navigator').innerHTML = `This Device has at least <b>${memory}</b> GiB of RAM | <b>${hardware}</b> CPU available.`;
      </pre>
    </details>
    <hr>
    <details>
      <summary>
        <strong>Battery Status API</strong><br />
        <code>システムのバッテリーに関する情報を提供する API</code>
        <meter id="progress" min="0" low="10" high="20" max="100"></meter>
      </summary>
      <aside>
        <a href="https://developer.mozilla.org/ja/docs/Web/API/Battery_Status_API">
          <i>Battery Status API</i>
          <p>バッテリー状態 API</p>
        </a>
        <a href="https://developer.mozilla.org/ja/docs/Web/API/Navigator/getBattery">
          <i>Navigator</i>
          <p>.getBattery()</p>
        </a>
      </aside>
      <p>バッテリー状態 API は、システムのバッテリー充電レベルに関する情報の提供、およびバッテリーレベルや充電状態が変化したときに発生するイベントによる通知を可能にします。</p>
      <p>これは、バッテリーが消耗したときにバッテリー消費を減らすためアプリのリソース使用状況を調整したり、データを失わないためにバッテリーが切れる前に変更点を保存したりするために使用できます。</p>
      <br />
      <pre>
navigator<code class="red">.getBattery</code>().then((battery) => {
  function updateAllBatteryInfo() {
    updateChargeInfo();
    updateLevelInfo();
    updateChargingInfo();
    updateDischargingInfo();
  }
  updateAllBatteryInfo();

  battery.addEventListener("chargingchange", () => {
    updateChargeInfo();
  });
  function updateChargeInfo() {
    document.querySelector('#charging').innerText = `${<code class="red">battery.charging</code> ? "充電中" : "放電中"}`;
  }

  battery.addEventListener("levelchange", () => {
    updateLevelInfo();
  });
  function updateLevelInfo() {
    document.querySelector('#level').innerText = `${<code class="red">battery.level</code> * 100} %`;
  }

  battery.addEventListener("chargingtimechange", () => {
    updateChargingInfo();
  });
  function updateChargingInfo() {
    if (<code class="red">battery.chargingTime</code> === Infinity) {
      document.querySelector('#chargingTime').innerText = '-';
    } else {
      document.querySelector('#chargingTime').innerText = `${<code class="red">battery.chargingTime</code>} 秒`;
    }
  }

  battery.addEventListener("dischargingtimechange", () => {
    updateDischargingInfo();
  });
  function updateDischargingInfo() {
    if (<code class="red">battery.dischargingTime</code> === Infinity) {
      document.querySelector('#dischargingTime').innerText = '-';
    } else {
      document.querySelector('#dischargingTime').innerText = `${<code class="red">battery.dischargingTime</code>} 秒`;
    }
  }
});
      </pre>
    </details>

    <table class="size">
      <tbody>
        <tr>
          <td>battery.charging</td>
          <td>現在充電されているかどうか</td>
          <td id="charging" class="nowValue"></td>
        </tr>
        <tr>
          <td>battery.level</td>
          <td>現在の充電レベル</td>
          <td id="level" class="nowValue"></td>
        </tr>
        <tr>
          <td>battery.chargingTime </td>
          <td>完全に充電されるまでの残り時間</td>
          <td id="chargingTime" class="nowValue"></td>
        </tr>
        <tr>
          <td>battery.dischargingTime</td>
          <td>完全に放電されるまでの残り時間</td>
          <td id="dischargingTime" class="nowValue"></td>
        </tr>
      </tbody>
    </table>
  </article>
</body>

</html>